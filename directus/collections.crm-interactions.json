{
  "collections": [
    {
      "collection": "interactions",
      "meta": {
        "icon": "call",
        "note": "Registo único de eventos (chamadas/mensagens) vindos da Central, WhatsApp, Typebot, Chatwoot, Email, etc. Serve como histórico e auditoria. Um evento pode ligar a um lead e/ou contacto.",
        "display_template": "{{type}} • {{source}} • {{display_name}}"
      },
      "schema": { "name": "interactions" },
      "fields": [
        { "field": "id", "type": "uuid", "meta": { "hidden": true }, "schema": { "is_primary_key": true } },
        { "field": "created_at", "type": "timestamp", "meta": { "readonly": true, "hidden": true } },

        { "field": "type", "type": "string", "meta": { "interface": "select-dropdown", "display_name": "Tipo" } },
        { "field": "direction", "type": "string", "meta": { "interface": "select-dropdown", "display_name": "Direção" } },
        { "field": "status", "type": "string", "meta": { "interface": "select-dropdown", "display_name": "Estado" } },
        { "field": "source", "type": "string", "meta": { "interface": "select-dropdown", "display_name": "Origem (canal)" } },

        { "field": "external_id", "type": "string", "meta": { "interface": "input", "display_name": "ID Externo (central/chat/...)"} },
        { "field": "occurred_at", "type": "timestamp", "meta": { "interface": "datetime", "display_name": "Data/Hora do evento" } },

        { "field": "phone", "type": "string", "meta": { "interface": "input", "display_name": "Telefone" } },
        { "field": "email", "type": "string", "meta": { "interface": "input", "display_name": "Email" } },
        { "field": "display_name", "type": "string", "meta": { "interface": "input", "display_name": "Nome/Identificação" } },

        { "field": "lead_id", "type": "string", "meta": { "interface": "input", "display_name": "Lead (id)" } },
        { "field": "contact_id", "type": "string", "meta": { "interface": "input", "display_name": "Contacto (id)" } },

        { "field": "summary", "type": "string", "meta": { "interface": "input", "display_name": "Resumo" } },
        { "field": "payload", "type": "json", "meta": { "interface": "json", "display_name": "Payload (raw)" } }
      ]
    }
  ],
  "notes": [
    "Sugestão de enums: type=[call,message,form], direction=[in,out], status=[incoming,answered,missed,spam,rejected,processed].",
    "O n8n pode criar 1 interação por evento recebido e, em paralelo, criar/atualizar `leads` para acionar o popup.",
    "Depois ligamos isto ao Card360 para mostrar histórico completo."
  ]
}

